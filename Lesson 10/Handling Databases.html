
<!-- saved from url=(0063)http://courses.oreillyschool.com/Python2/HandlingDatabases.html -->
<html><!-- Copyright (c) 1998-2014 O'Reilly Media, Inc.
			This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License.
			See http://creativecommons.org/licenses/by-sa/3.0/legalcode for more information.
            --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" type="text/css" href="./Handling Databases_files/Lab.css"><script async="" src="./Handling Databases_files/analytics.js"></script><script type="text/javascript" src="./Handling Databases_files/Lab.js"></script><script language="javascript"></script><title>Handling Databases</title></head><body id="body" style="font-size: 12px;"><a name="top"></a><div class="title">Handling Databases</div><div class="resize"><a href="http://courses.oreillyschool.com/Python2/HandlingDatabases.html#top" onclick="changeSize(&#39;smaller&#39;);" class="aS" title="Keep clicking to make fonts smaller">A</a><a href="http://courses.oreillyschool.com/Python2/HandlingDatabases.html#top" onclick="changeSize(&#39;larger&#39;);" class="aL" title="Keep clikcing to make fonts larger">A</a><a href="http://courses.oreillyschool.com/Python2/HandlingDatabases.html#top" onclick="lv()" class="lv" title="Adjust Page for High Contrast">HC</a><div id="fh"><p>Click on <span class="aS">A</span> to make all fonts on the page smaller.</p><p>Click on <span class="aL">A</span> to make all fonts on the page larger.</p><p>Click on <span class="lv">HC</span> to toggle high contrast mode. When you move your mouse over 
                 some bold words in high contrast mode, related words are automatically highlighted. Text is shown
                 in black and white. 
             </p></div></div><hr>
    
    <div class="goalTitle">Lesson Objectives</div><div class="goals">When you complete this lesson, you will be able to:
        
        <ul><li>use the
                MySQL database.</li><li>use the Structured Query Language (SQL), a command-based free-form language.</li><li>use the Data Definition Language (DDL), the subset of SQL that allows you to define 
                and modify database objects such
                as tables and indexes.</li><li>use the Data Manipulation Language (DML).</li><li>use a special value called <i>null</i> to represent the fact that either no data 
                is available.</li><li>create a new database with a table for storing basic information.</li><li>incorporate foreign keys to express the fact that relationships exist between two entities.</li></ul></div><hr>

    <a name="h_01"></a><div class="heading">Relational Databases: Representing the World in Tables</div><div class="headingText">

        <p>You haven't had enough yet? Good! Let's keep our momentum going then, and start talking about relational databases.
            Relational databases are based on complex discrete mathematics. Fortunately though,
            we don't need to master all of those complex mathematics in order to get the most from a
            database: the concepts are actually pretty intuitive.</p>

        <p>Relational databases use a language called the <i>Structured Query
            Language</i> (abbreviated as <i>SQL</i>) to define data structures, and store and retrieve
            information. SQL is different from most computer languages
            in that it is <i>declarative</i>—you don't tell the database how to produce what
            you want, you simply describe what you want it to do and the database works out how best
            to do it.</p>

        <p>Database systems are often built as "client/server" systems—your
            program is a client (maybe one of many) of a server program that runs as a separate
            process, or maybe even on an entirely separate "database server" computer. 
            The diagram below of a MySQL database environment, depicts how some programs use
            the <i>MySQL protocol</i>—that's a way of speaking SQL that's particular to MySQL clients and
            servers—to the database server: </p>

        <p></p><div class="c">
            <img src="./Handling Databases_files/MySQLEnvironment.png">
        </div><p></p>

        <p> Okay, let's get this party started. First we'll run SQL on a MySQL database server 
            elsewhere in the O'Reilly
            School network. Your Ellipse setup will be the client in the top left-hand corner,
            connecting via the <i>SSH</i> protocol to another computer, on which you will enter SQL
            commands to a Linux MySQL client program. The database client program will then present your
            SQL to the database server, where the engine will process it. </p>

        <p>Then we'll move on to Python database programming.
            Your programs will resemble the lower of the two remote processes in the diagram,
            where you use Python to interact with the database, by means of a special piece of driver
            software. Think of your program like this:</p>

        <p></p><div class="c"><img src="./Handling Databases_files/PythonDBAPI.png"></div><p></p>

        <p>(Do you love our sweet diagrams or what?) In this course, you will use a MySQL database 
            provided by OST. 
            Your database uses
            the same credentials (login name and password) as the other O'Reilly School systems you use,
            and its name is the same as your user name. We've saved you 
            the trouble of installing your own database server; the care and feeding of these beasts
            requires some expertise! Your database programs will maintain their data on O'Reilly's servers. </p>

        <p> MySQL conforms closely to the <a href="http://www.python.org/dev/peps/pep-0249/" target="_blank">Python DBAPI</a> specifications for the way your programs should interact 
            with the database. Support
            for many relational databases, both open source and proprietary, is readily available
            using well-tried third-party modules. </p>

        <p>SQL is the common interface between databases and their applications. This
            means that you don't need to incorporate information about the physical
            representation of data on the storage media. Also, SQL processors do all the "grunt
            work" of optimization, and do not require programmers to specify the complex operations
            that complex queries require. </p>

    </div>
    <a name="h_02"></a><div class="heading">Your First Database Interactions</div><div class="headingText">

        <a name="s_01"></a><div id="s_01"><div class="subheading">Access to a Database</div><div class="subheadingText">

            <p>The MySQL database server is a popular open-source database software, and is 
                available for use on a wide variety of platforms. We'll use the
                MySQL database for our examples.</p>

            <p>As we mentioned earlier, in this course, you have access to the MySQL database on the OST server. 
                You can access that database using the same username
                and password that you use to log onto your courses. Your username is also the name
                of your database.</p>

            <p>If you write in an SQL dialect that most database systems support, your SQL (and
                therefore your programs) should run successfully against most database systems without change.
                Even though SQL is standardized, each database vendor has a different interface, as
                well as different extensions of SQL. We create our notes and examples here to be
                general-purpose, so you can use them on this or other databases, but remember that
                changes <i>may</i> be required.</p>

            <p>First, we'll connect to your Unix account using SSH. To do that, use the
                    <b>Terminal</b> tab in Ellipse.</p>

            <p>Click the <b>Terminal</b> tab and then the <b>Connect</b> icon: </p>

            <p></p><div class="c"><img src="./Handling Databases_files/TerminalTab.png"></div><p></p>

            <p>If a Terminal Settings dialog appears, select SSH for the Connection Type, 
                enter <b>cold.oreillyschool.com</b> for the 
                Host, and enter the username and password you used to get into this course, and 
                click <b>OK</b>.</p>

            

            <p>An authenticity warning appears:</p>

            <p>
                </p><div class="c">
                    <img src="./Handling Databases_files/AuthenticityWarning.png">
                </div>
            <p></p>
            
            <p>Click <b>Yes</b> to continue and make the connection.</p>
            
        </div></div>
        <a name="s_02"></a><div id="s_02"><div class="subheading">Running MySQL</div><div class="subheadingText">

            <p>At the cold:~$ prompt, type:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>cold:~$ <ins>mysql -h sql -u &lt;username&gt; -p &lt;username&gt;</ins>
</pre></div></div>
       
<div class="observeBox"><div class="observeTitle">OBSERVE: Starting mysql at the cold Prompt</div><div class="observe"><pre>mysql -h sql -u <span class="darkblue">&lt;username&gt;</span> -p <span class="darkred">&lt;username&gt;</span>
</pre></div></div>
            
            <p>(At the first instance of <span class="darkblue">username</span>, enter the name you use to login to
                this course; for the second instance,  <span class="darkred">username</span> should be replaced with
                your login name as well—this will become the name of the database.) When prompted
                for a password (as required by the -p option), enter the password you use to login to
                this course. You'll see a <b>mysql&gt;</b> prompt:</p>

            <p>
                </p><div class="c">
                    <img src="./Handling Databases_files/StartingMySQL.png">
                </div>
            <p></p>

            <p>Excellent! You're in!</p>

        </div></div>
    </div>
    <a name="h_03"></a><div class="heading">Structured Query Language</div><div class="headingText">

        <p>Structured Query Language (SQL) is a command-based free-form language. All whitespace is
            considered equivalent, and the keywords, table names, and column names are not
            case-sensitive. It is common convention to
            write SQL keywords in upper-case letters so they can be readily identified.</p>

        <p>In fact, MySQL is picky about table names, and it's best practice
            to remain consistent, using the exact table names that you create originally. 
            No database will ever complain because you got
            the case right! </p>

        <p>Each statement in SQL begins with a characteristic verb or phrase, which indicates the
            broad purpose of the statement. SQL actually includes three sub-languages, two of
            which we'll consider in this course: 
            Data Definition Language and Data Manipulation Language. (The third, Data Control Language or DCL, is
            used to determine which users get permission to perform which operations on which pieces
            of data, and is outside the scope of this course.)</p>

        <a name="s_01"></a><div id="s_01"><div class="subheading">Data Definition Language (DDL)</div><div class="subheadingText">

            <p>DDL is the subset of SQL that allows you to define and modify database objects such
                as tables and indexes. There are three basic verbs used in DDL:</p>

            <ul><li><b>CREATE</b> inserts new definitions into the data dictionary.</li><li><b>DROP</b> removes definitions from the data dictionary.</li><li><b>ALTER</b> modifies definitions already present in the data dictionary.</li></ul>

            <p>Here is a description of two relational tables that might be part of a library
                information system. At the mysql prompt, enter the SQL shown below to create two tables:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>CREATE TABLE Book(</ins>
 	-&gt; <ins>BkISBN CHAR(12) NOT NULL,</ins>
    -&gt; <ins>BkTitle VARCHAR(30) NOT NULL,</ins>
    -&gt; <ins>BkPubNo INT,</ins>
    -&gt; <ins>BkYear INT) ENGINE = MYISAM;</ins>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <ins>CREATE TABLE Publisher(</ins>
 	-&gt; <ins>PubNo INT PRIMARY KEY,</ins>
 	-&gt; <ins>PubName VARCHAR(25),</ins>
 	-&gt; <ins>PubURL VARCHAR(50)) ENGINE = MYISAM;</ins>
Query OK, 0 rows affected (0.01 sec)
</pre></div></div>

            <p>Here you create a table in SQL using the phrase "CREATE TABLE" followed by the name of the
                table you want to create, followed by a parenthesized list of column specifications
                separated by commas. Each column specification determines the data type of the
                values that are stored in the column and can specify other constraints (PRIMARY KEY
                specifies a constraint on the Publisher table—we'll learn about others
                later). </p>

            <p>In many database systems, constraints do not need to be specified when the table is
                created. They can be added later using the ALTER TABLE statement. Now enter these statements 
                in mysql for the tables you defined:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>ALTER TABLE Book</ins>
    -&gt;    <ins>ADD CONSTRAINT Bk_PK</ins>
    -&gt;    <ins>PRIMARY KEY(BkISBN);</ins>

mysql&gt; <ins>ALTER TABLE Book</ins>
    -&gt;    <ins>ADD CONSTRAINT Bk_Pub_FK</ins>
    -&gt;    <ins>FOREIGN KEY (BkPubNo) REFERENCES Publisher(PubNo);</ins>
</pre></div></div>

            <p>The second statement expresses the fact that a <i>relationship</i> exists between
                Book and Publisher: each book is related to (published by) one of the publishers in the 
                Publisher
                table. A publisher is identified by its primary key (the value of the
                <b>PubNo</b> column). Consequently, the publisher of a given book is recorded
                by storing the appropriate <b>PubNo</b> value from Publisher, as the value of
                the <b>BkPubNo</b> column for the row representing the book. We'll talk more about
                relationships later.</p>

        </div></div>
        <a name="s_02"></a><div id="s_02"><div class="subheading">Data Manipulation Language (DML)</div><div class="subheadingText">

            <p>This is the most commonly used subset of SQL; it is used to manipulate and
                query the data in the relational structures maintained by the DDL, and is what
                updates the model and answers questions based on its content. There are four
                statements in the Data Manipulation Language: </p>

            <ul><li><b>INSERT</b> adds new rows to user tables. </li><li><b>SELECT</b> retrieves information from one or more tables in the database
                    (including data dictionary tables if requested). </li><li><b>UPDATE</b> allows changes to be made to existing rows in user tables. </li><li><b>DELETE</b> removes rows from user tables. </li></ul>

            <h4>INSERT: Adding A Row to a Table</h4>

            <p>Now, we'll use the INSERT statement to insert some book and publisher data. In
                mysql, enter the code as shown: </p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>INSERT INTO Publisher (PubNo, PubName, PubURL)</ins>
    -&gt; <ins>VALUES (1, 'O''Reilly', 'www.ora.com');</ins>
Query OK, 1 row affected (0.00 sec)

mysql&gt; <ins>INSERT INTO Publisher (PubNo, PubName, PubURL)</ins>
    -&gt; <ins>VALUES (2, 'New Riders', 'www.newriders.com');</ins>
Query OK, 1 row affected (0.00 sec)

mysql&gt; <ins>INSERT INTO Book (BkISBN, BkTitle, BkPubNo, BkYear)</ins>
    -&gt; <ins>VALUES('7807', 'Python Web Programming', 2, 2002);</ins>
Query OK, 1 row affected (0.00 sec)

mysql&gt; <ins>INSERT INTO Book (BkISBN, BkTitle, BkPubNo, BkYear)</ins>
    -&gt; <ins>VALUES('0596', 'Learning Python', 1, 2009);</ins>
Query OK, 1 row affected (0.00 sec)
</pre></div></div>

            <p>Each INSERT statement adds one row to the database table, named after the "INSERT
                INTO" clause. The values in the VALUES list match up with the columns given in the
                list immediately following the table name. </p>

            <p><table class="noteBox fBox pBox "><tbody><tr><td class="noteTitle">Note</td><td class="note">You may see code containing SQL INSERT statements that don't include the list of 
                column names, instead relying on the order of the column names when the table was created. 
                This is not a best practice.</td></tr></tbody></table></p>

            <h4>SELECT: Retrieve Data from One or More Tables</h4>

            <p>Once you have data in your database, you can retrieve information using the SELECT
                statement. Enter the code below as shown:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>SELECT BkTitle, BkISBN, PubName</ins>
    -&gt; <ins>FROM Book JOIN Publisher ON BkPubNo = PubNo;</ins>
+------------------------+--------+------------+
| BkTitle                | BkISBN | PubName    |
+------------------------+--------+------------+
| Python Web Programming | 7807   | New Riders |
| Learning Python        | 0596   | O'Reilly   |
+------------------------+--------+------------+
2 rows in set (0.05 sec)

mysql&gt;
</pre></div></div>

            <p>The statement above retrieves the ISBN and title of the book from the Book table and
                the relevant publisher's name from the Publisher table, and puts them together—this
                is called <i>joining</i> the tables. This results in the two rows of data shown.</p>

   <h4>UPDATE: Modify Existing Data in a Table</h4>
            
            <p>The UPDATE statement is used to modify existing data, and can change zero, one, or
                more rows in a single table. Suppose a second edition of <i>Python Web
                Programming</i> were published, then the database could be modified to reflect the new book
                Add the code below as shown:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>UPDATE Book SET BkTitle='Python Web Programming, 2nd Ed',</ins>
    -&gt; <ins>BkYear=2010</ins>
    -&gt; <ins>WHERE BkISBN='7807';</ins>
Query OK, 1 row affected (0.05 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt;
    
mysql&gt; <ins>SELECT * FROM Book;</ins>
+--------+--------------------------------+---------+--------+
| BkISBN | BkTitle                        | BkPubNo | BkYear |
+--------+--------------------------------+---------+--------+
| 7807   | Python Web Programming, 2nd Ed |       2 |   2010 |
| 0596   | Learning Python                |       1 |   2009 |
+--------+--------------------------------+---------+--------+
2 rows in set (0.04 sec)

mysql&gt;
</pre></div></div>

            <p>The output from the SELECT statement (the "*" simply means "all columns") shows that,
                in this case, precisely one row was updated by the UPDATE statement. That happened
                because the WHERE clause specified a condition that was only met by one row in the
                given table. </p>

            <h4>DELETE: Remove Rows From a Table</h4>

            <p>The DELETE statement removes all rows meeting a specific condition, again expressed
                in a WHERE clause. You need to be <i>really</i> careful here—if you do not
                specify a WHERE clause, all rows in the table will disappear! At the MySQL prompt
            type the code below as shown:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>DELETE FROM Book WHERE BkISBN='0596';</ins>
Query OK, 1 row affected (0.00 sec)

mysql&gt; <ins>SELECT * FROM Book;</ins>
+--------+--------------------------------+---------+--------+
| BkISBN | BkTitle                        | BkPubNo | BkYear |
+--------+--------------------------------+---------+--------+
| 7807   | Python Web Programming, 2nd Ed |       2 |   2010 |
+--------+--------------------------------+---------+--------+
1 row in set (0.04 sec)

mysql&gt;
</pre></div></div>
        
        </div></div>
  <a name="s_03"></a><div id="s_03"><div class="subheading">Having No Data: The Null Value</div><div class="subheadingText">
            
      <p>Relational systems use a special value called <i>null</i> to represent the fact that either no data 
          is available for a specific column in a given row, or that that column is irrelevant in the case 
          of the particular row in question. </p> 
            
      <p>While the null value (indicated as NULL in SQL statements) has its uses, you need to be careful of 
          its counter-intuitive properties. Because the null value in effect represents the absence of data, 
          it introduces a third possibility beyond true or false—unknown—as the result of a 
          comparison.</p>
            
      <p>Consequently, if you are testing a column for a given value, NULLs will not be included whether you 
          test for equality or inequality (which you do IN SQL using "=" and "&lt;&gt;", respectively). Since 
          we are used to the value of a comparison being true or false, it's easy to forget to take 
          this oddity into account. Use mysql to check this out. 
          Enter this SQL to see how NULL values affect comparisons: </p>
            
<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>INSERT INTO Book (BkISBN, BkTitle, BkPubNo)</ins>
    -&gt; <ins>VALUES ('1234', 'Pythonic Attitudes', 2);</ins>
Query OK, 1 row affected (0.01 sec)

mysql&gt; <ins>INSERT INTO Book (BkISBN, BkTitle, BkPubNo, BkYear)</ins>
    -&gt; <ins>VALUES ('0987', 'My Little Python', 1, 2005);</ins>
Query OK, 1 row affected (0.01 sec)

mysql&gt; <ins>SELECT * FROM Book;</ins>
+--------+--------------------------------+---------+--------+
| BkISBN | BkTitle                        | BkPubNo | BkYear |
+--------+--------------------------------+---------+--------+
| 7807   | Python Web Programming, 2nd Ed |       2 |   2010 |
| 1234   | Pythonic Attitudes             |       2 |   NULL |
| 0987   | My Little Python               |       1 |   2005 |
+--------+--------------------------------+---------+--------+
3 rows in set (0.05 sec)

mysql&gt;
</pre></div></div>

      <p>See the NULL value in the BkYear column for "Pythonic Attitudes?" (That's right, I said it. Pythonic Attitudes.) 
          Now we'll run a number of queries 
          on this updated data. Enter this SQL in the MySql Terminal Window:</p>
            
<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>SELECT COUNT(*) FROM Book;</ins>
+----------+
| COUNT(*) |
+----------+
|        3 |
+----------+
1 row in set (0.04 sec)

mysql&gt; <ins>SELECT COUNT(*) FROM Book WHERE BkYear &lt;= 2005;</ins>
+----------+
| COUNT(*) |
+----------+
|        1 |
+----------+
1 row in set (0.04 sec)

mysql&gt; <ins>SELECT COUNT(*) FROM Book WHERE BkYear &gt; 2005;</ins>
+----------+
| COUNT(*) |
+----------+
|        1 |
+----------+
1 row in set (0.04 sec)

mysql&gt; 
</pre></div></div>

      <p>So, we have three books; one published 2005 or earlier, and one published after 2005, and...wait 
          a minute! If you don't see the problem here, think about how many books there are in the Books 
          table. The first query answers that: there are three. Okay, so how many of them were published in 
          or before 2005? The second query tells us there is one. The third query tells us that there is only 
          one book published <i>after 2005</i>—the answer is again, one. But one plus one isn't three, 
          and it's easy to overlook that the book with no year data couldn't be included in either result 
          set.</p>
            
      <p>You need to be careful of little things like this when your data allows NULL values, and we 
          recommend that another best practice is to allow NULL values only where you actively want to permit 
          them. So, you find out how many books there are in total by giving the SQL 
          <span class="darkgreen">COUNT()</span> function a "*" (all rows) argument. Counting the <b>BkYear</b> 
          column is no good—because NULL values in that column are omitted from the 
          <span class="darkgreen">COUNT()</span>. Let's verify in the MySQL Terminal Window that NULLs are not COUNTed. 
          Type in the code below as shown:</p>
            
<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>SELECT COUNT(BkYear) FROM Book;</ins>
+---------------+
| COUNT(BkYear) |
+---------------+
|             2 |
+---------------+
1 row in set (0.04 sec)

mysql&gt;</pre></div></div>

      <p>Only two of our books have a BkYear. When we entered the "Pythonic Attitudes" book data, we 
          didn't include a value for the year (sorry, we did that deliberately). In the result from the 
          <b>SELECT * FROM Book</b> query, we mentioned that the value for <span class="darkred">BkYear</span> for 
          that row was <b>NULL</b>.</p>
            
      <p></p><div class="c"><table class="noteBox fBox pBox "><tbody><tr><td class="noteTitle">Note</td><td class="note">Data that can take the NULL value is sometimes referred to as <i>optional</i>.</td></tr></tbody></table></div><p></p>
            
      <p>So, we used <span class="darkgreen">COUNT()</span>, a SQL function that aggregates the number of 
          rows that meet the given condition. A count of all rows clearly shows three rows, but we only saw 
          one row with a year less than or equal to 2005 and one with a year that was greater than 2005. The third 
          row didn't get counted by either of those conditions. The final query, where we explicitly counted
          the number of <b>BkYear</b> entries, makes it apparent that only two rows have an entry in that 
          column.</p>
        
  </div></div>
    </div>
    <a name="h_04"></a><div class="heading">Creating a Table and Inserting Data</div><div class="headingText">

        <p>Tables are at the heart of a database. Each table in a properly designed database, holds
            data concerning precisely one type of thing (an <i>entity type</i>, as it is more formally
            called in the database world). Suppose you want to keep information about a zoo; you
            would certainly want to record information about the animals, and you could do so in a single table. </p>

        <p>Let's create a new table in our database for storing basic information about zoo animals.
            Again, if it's not still running, open a terminal window and start mysql. 
            Enter the code below in an interactive window to create a new table:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>CREATE TABLE animal(</ins>
    -&gt; <ins>id INTEGER PRIMARY KEY AUTO_INCREMENT,</ins>
    -&gt; <ins>name VARCHAR(50),</ins>
    -&gt; <ins>family VARCHAR(50),</ins>
    -&gt; <ins>weight INTEGER) ENGINE = MYISAM;</ins>
Query OK, 0 rows affected (0.03 sec)
</pre></div></div>

        
    <a name="s_01"></a><div id="s_01"><div class="subheading">Attributes are Columns, Occurrences are Rows</div><div class="subheadingText">

            <p>In the example above, you used a "CREATE TABLE" statement to create a table
                interactively with four columns: <b>id</b>, <b>name</b>, <b>family</b>, and <b>weight</b>. <b>id</b> 
                and <b>weight</b> hold integer values; <b>name</b> and <b>family</b>
                hold character strings of varying
                length. Each column represents a different piece of data about
                each animal that can be stored—they are sometimes referred to as "attributes" of the animal
                entity.</p>

            <p>The PRIMARY KEY column designation plays a special role in the table, which we'll
                discuss at length later. For now, be aware that using
                its primary key is the only way to guarantee that you are referring to a single row
                in the table; primary key values are always unique.</p>

            <p>Now that we've created our table, let's put some data into it. The code below shows
                how to use the SQL "INSERT" statement. If you were writing SQL for direct execution
                by the database, you would write something like this:</p>

            <p>INSERT INTO animal (id, name, family, weight) VALUES (1, 'Ellie', 'Elephant', 2350)</p>

            <p>Note that SQL <i>always</i> uses single quotation marks to delimit string values. In a
                program though, you usually have the data in variables. While you <i>could</i>
                build the exact SQL statement you want to run using string manipulation, this is a
                really bad idea. If the data strings are from user input, it is too easy to allow
                the user to mess up your SQL, sometimes with disastrous results (try searching the
                web for "SQL injection vulnerability" to see how bad this can be).
                Fortunately, Python provides a mechanism to avoid these unpleasant security
                vulnerabilities. Which brings us to consider how your programs will interact with
                the database.</p>

  </div></div>
  <a name="s_02"></a><div id="s_02"><div class="subheading">The Python Database API</div><div class="subheadingText">
            
      <p>We've used SQL at the command line after securely logging in to a remote Linux system. Now we 
          need to learn how to use it from inside of our Python programs, so that instead of just displaying 
          the data we retrieve, we can execute Python statements using the data. That should make things a bit more 
          interesting! </p>
            
      <p>In order for a Python program to be able to talk to a database, it uses a special driver module. We 
          are using the <b>mysql.connector</b> module, calling its <span class="darkgreen">Connect()</span> function 
          to identify ourselves and obtain a database connection. Once the connection is created, a 
          <i>cursor</i> is used to execute SQL commands over that connection. This program only inserts data 
          into the database; it does not attempt to retrieve any data.</p>
            
      <p>The DBAPI provides a solution to the SQL injection problem by allowing you to make 
          what are called "parameterized queries." They're a little like passing arguments to Python functions. 
          You include a special "parameter mark" ("%s" for the <b>mysql.connector</b> module we use in this 
          course) in the SQL statement to represent each piece of data, and then provide the data itself as 
          an additional tuple to your database cursor's <span class="darkgreen">execute()</span> method. Let's write 
          a program to insert data into our animal table. Create a new PyDev project named 
          <b>HandlingDatabases</b> and assign it to the <b>Python2_Lessons</b> working set. Then, in the <b>HandlingDatabases/src</b> folder, create 
          <b>tablepop.py</b> as shown:</p>

<div class="listingBox"><div class="listingTitle">CODE TO TYPE:</div><div class="listing"><pre><ins>"""
Populates a table with data from a Python tuple.
"""
import mysql.connector
from database import login_info

if __name__ =="__main__":

    db = mysql.connector.Connect(**login_info)
    cursor = db.cursor()
    
    data = (
            ("Ellie", "Elephant", 2350),
            ("Gerald", "Gnu", 1400),
            ("Gerald", "Giraffe", 940),
            ("Leonard", "Leopard", 280),
            ("Sam", "Snake", 24),
            ("Steve", "Snake", 35),
            ("Zorro", "Zebra", 340)
            )
    
    cursor.execute("DELETE FROM animal")
    for t in data:
        cursor.execute("""
        INSERT INTO animal (name, family, weight)
        VALUES (%s, %s, %s)""", t)
        
    db.commit()
    print("Finished")</ins>
</pre></div></div>
      
      <p>When you <img src="./Handling Databases_files/icon_run.png"> save and run this program, naturally, it raises 
          an exception; rather than insert our login credentials into this program, we're importing them as 
          something called <b>login_info</b> from a module named <b>database</b>, which doesn't yet exist.</p> 
      
      <p></p><div class="c"><table class="noteBox fBox pBox "><tbody><tr><td class="noteTitle">Note</td><td class="note">You may see a warning on the <b>import mysql.connector</b> line in this program. Ignore it for 
          now.</td></tr></tbody></table></div><p></p>    
      
      <p>Create <b>database.py</b> in your <b>HandlingDatabases/src</b> folder, entering <i>your</i> login 
          username in place of "<i>username</i>" and your password in place of "<i>password</i>":</p>

<div class="listingBox"><div class="listingTitle">CODE TO TYPE:</div><div class="listing"><pre><ins>
USERNAME = "<i>username</i>"
PASSWORD = "<i>password</i>"

login_info = {
            'host': "sql.oreillyschool.com",
            'user': USERNAME,
            'password': PASSWORD,
            'database': USERNAME,
            'port': 3306
            }</ins>
</pre></div></div>

      <p>This code creates a dict. The dict's items will become keyword arguments to the 
          <span class="darkgreen">mysql.connector.Connect()</span> function (remember, the "**" tells the interpreter 
          to convert the dict into a set of keyword arguments). Normally, to connect to a database server, 
          you need to know a few pieces of information, which you have to pass to the driver when connecting 
          to the database. The names of the first four arguments (host, user, password, and database) will 
          probably make their purpose obvious. The fifth argument, port, is required so the driver knows 
          exactly where to connect on the database server. Save this <b>database</b> module, then re-run 
          <img src="./Handling Databases_files/icon_run.png"> tablepop.py. The program inserts seven rows into your 
          database's animal table, and prints FINISHED. But don't take our word for it—check for 
          yourself after you learn what your program did! Let's look at the code more closely:</p>

<div class="observeBox"><div class="observeTitle">OBSERVE: tablepop.py</div><div class="observe"><pre>"""
Populates a table with data from a Python tuple.
"""
import mysql.connector
from database import login_info

if __name__ =="__main__":

    db = mysql.connector.Connect(<span class="purple">**login_info)</span>
    <span class="darkgreen">cursor = db.cursor()</span>
    
    <span class="darkred">data = (
            ("Ellie", "Elephant", 2350),
            ("Gerald", "Gnu", 1400),
            ("Gerald", "Giraffe", 940),
            ("Leonard", "Leopard", 280),
            ("Sam", "Snake", 24),
            ("Steve", "Snake", 35),
            ("Zorro", "Zebra", 340)
            )</span>
    
    cursor.execute("DELETE FROM animal")
    for t in <span class="darkred">data</span>:
        cursor.<span class="darkgreen">execute("""
        INSERT INTO animal (name, family, weight)
        VALUES (%s, %s, %s)""", t)</span>
        
    db.commit()
    print("Finished")
</pre></div></div>       
      <p>First let's consider the database connection. The statement 
          <b>db = mysql.connector.Connect(<span class="purple">**login_info</span>)</b> is equivalent to 
          <b>db = mysql.connector.Connect(<span class="purple">host= ..., user= ..., ...</span>)</b>, with the dict 
          imported from the <b>database</b> module providing both the names and the values of the 
          parameters to the <b>Connect()</b> function. </p>
            
      <p>Next, the statement <span class="darkblue">cursor = db.cursor()</span> creates a database cursor, which is 
          how we present SQL statements to the database for execution (you can create several cursors on the 
          same connection if you want to, but usually you won't do that). Next, the program loops over each of 
          the tuples in <span class="darkred">data</span>, presenting each tuple as the second argument to a call to 
          the cursor's <span class="darkgreen">execute()</span> method. </p>

      <p>Each time we called the <span class="darkgreen">cursor.execute()</span> method, we provided the same 
          parameterized SQL INSERT statement (containing three "%s" <i>parameter marks</i> to indicate where 
          the data should go) as the first argument. The second argument was the tuple of data items. This 
          inserted a new row into the animal table. </p>

      <p><table class="noteBox fBox pBox "><tbody><tr><td class="noteTitle">Note</td><td class="note">The INSERT statement didn't provide a value for the <b>id</b> column. Where did the IDs come 
          from? When we created the table, we declared <b>id</b> as <b>INTEGER PRIMARY KEY AUTO_INCREMENT</b>. 
          AUTO_INCREMENT specifies that the <b>id</b> column of any row that is inserted into the table with 
          no <b>id</b> value specified, will be set to one greater than the highest value that was ever stored 
          in that column. In practice, this normally means that values start at one and go up, which is what 
          we see here. If you have inserted and deleted other rows (good for you for experimenting!), you 
          might see different numbering.</td></tr></tbody></table> </p>

      <p>So, now that we know what was supposed to happen inside <b>tablepop.py</b>, we should check to make sure that it 
          ran correctly!</p>
       
       <p>In the Terminal tab, open a connection to the database, and verify the contents of 
           the <b>animal</b> table. Type this code at the mysql prompt:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>SELECT * FROM animal;</ins>
+----+---------+----------+--------+
| id | name    | family   | weight |
+----+---------+----------+--------+
|  1 | Ellie   | Elephant |   2350 |
|  2 | Gerald  | Gnu      |   1400 |
|  3 | Gerald  | Giraffe  |    940 |
|  4 | Leonard | Leopard  |    280 |
|  5 | Sam     | Snake    |     24 |
|  6 | Steve   | Snake    |     35 |
|  7 | Zorro   | Zebra    |    340 |
+----+---------+----------+--------+
7 rows in set (0.04 sec)
</pre></div></div>

  </div></div>
 </div>
 <a name="h_05"></a><div class="heading">Relationships and Foreign Keys: Referring to Occurrences</div><div class="headingText">

        <p>You already saw in the book/publisher example that it is possible for a row in one table
            to refer to a row in another table. Each book indicates its publisher in a column called
                <b>BkPubNo</b> that holds the value of the <b>PubNo</b> field of one of the rows in
            the Publisher table. </p>

        <p>The <b>BkPubNo</b> column in the Book table is called a <i>foreign key</i>—it
            stores a primary key value from some row in another table. Since primary key values are
            guaranteed to be unique, a foreign key value refers just once to a single instance of
            the related entity. </p>

        <p>Foreign keys are used to express the fact that relationships exist between two entities.
            In this case, we might say that "book is-published-by publisher," or equivalently that
            "publisher publishes book." Since each book can have only one publisher, but any given
            publisher can publish many books, we say that the relationship is "many-to-one" between
            book and publisher, or equivalently that it is "one-to-many" between publisher and book. </p>

        <p>Relationships can turn mere data into information. Without the relationships, we could not 
            show the publisher of each book in the query we ran earlier. </p>

    </div>
    <a name="h_06"></a><div class="heading">Integrity Constraints</div><div class="headingText">

        <p>For data to be stored in the database, it must meet certain rules, which are we'll summarize
           in a minute. Most relational databases will enforce these rules automatically to maintain the
            integrity of the relational structures. For this reason, the rules are often referred to
            as <i>integrity constraints</i>. Your application may also have its own integrity
            requirements imposed on the database content.</p>

        <p>For example, it's fairly common in order processing systems to assign each customer a
            credit limit, to allow them to purchase a certain amount without advance payment.
            Generally a customer's credit limit will be increased as they demonstrate their
            trustworthiness. When a new order is received, the system checks how much the customer
            already owes, and if the new order would take them over their credit limit, it refuses
            to release the new order (at least without some manual override action). So the
            constraint there is that each customer's unpaid order total must be less than their
            credit limit. Constraints imposed because of the organization's requirements are often
            referred to as <i>business rules</i>, or <i>semantic integrity constraints</i>, but they
            are still constraints. They are frequently so complex that it isn't reasonable to expect
            the database to maintain them without help from code in the application.</p>

        <p>In this section, we discuss the integrity constraints that we usually expect the database
            to maintain without any help. </p>

        <a name="s_01"></a><div id="s_01"><div class="subheading">Primary Keys Identify Occurrences</div><div class="subheadingText">

            <p><b>Each row of a table must be uniquely identifiable.</b> The easiest way to ensure
                this is to have a column or collection of columns that is guaranteed unique for
                every row in the table. This column (or collection) is designated as the <i>primary
                    key</i>. A primary key that is made up of more than one column is referred to as
                a <i>composite primary key</i>. The database will not allow two rows with the same
                primary key value to exist. You can see for yourself by trying to create a duplicate
                <b>id</b> value in the animal table. In the interactive console, type the code below as shown:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>INSERT INTO animal (id, name, family, weight)</ins>
    -&gt; <ins>VALUES (1, "Harold", "Hyena", 80);</ins>
ERROR 1062 (23000): Duplicate entry '1' for key 1
mysql&gt;
</pre></div></div>

            <p>The error message tells you that the row could not be created because that would have
                resulted in a duplicate primary key, which in turn would violate the built-in
                integrity constraint. </p>

        </div></div>
        <a name="s_02"></a><div id="s_02"><div class="subheading">No NULLs in Primary Key Values</div><div class="subheadingText">

            <p><b>No part of the primary key may be null</b>. The
                primary key is used as the unique identifier for the rows of a table. Since the
                result of a comparison between anything and null is unknown, it would be impossible
                to answer yes or no to the question "does the primary key of this row have that
                value?" </p>

        </div></div>
        <a name="s_03"></a><div id="s_03"><div class="subheading">No Multi-Valued Attributes</div><div class="subheadingText">

            <p><b>Attribute values must be "atomic"</b>. There is no way to store more than one
                value for a given attribute in any row. If you need to do that, you need to create a
                relationship instead. You can learn more about this under "<a href="http://courses.oreillyschool.com/Python2/HandlingDatabases.html#implementing_multivalued_attributes">Implementing Multi-Valued
                Attributes</a>" below.</p>

        </div></div>
        <a name="s_04"></a><div id="s_04"><div class="subheading">Referential Integrity</div><div class="subheadingText">

            <p><b>Foreign key values must exist as primary key values in the related table</b>. This
                is a fairly straightforward interpretation of the meaning of relationships. Because
                a book's publisher is indicated by its <b>BkPubNo</b> attribute, the value of that
                attribute must be a reference to a real publisher. </p>

        </div></div>
    </div>
 <a href="" name="implementing_multivalued_attributes"></a>
 <a name="h_07"></a><div class="heading">Implementing Multi-Valued Attributes</div><div class="headingText">
        
     <p>What if we wanted to store details about what each animal in our zoo eats? One way to do this 
         would be to add a <b>food</b> column to the table. But what if an animal can eat more than one type 
         of food? A common mistake of new database programmers make is to try and store several 
         values in a single column, as in this table: </p>
        
     <p></p><div class="c"><img src="./Handling Databases_files/animalDataFoodBad.png"></div><p></p>
        
     <p>Don't do this. The red <span class="red">X</span> is there to remind you that this is a terrible idea. Using 
         a table like this would make it next to impossible to 
         answer relatively simple queries like "which animals eat grass?" The solution to this problem is to 
         introduce an entirely new entity to store this information, and put the new entity in a relationship 
         with the animal entity by storing the primary key of the animal as an attribute of the new 
         <b>food</b> entity. Let's do that now. We'll use some DDL to create the new table and some 
         DML to add the rows. In the <b>HandlingDatabases/src</b> folder, create <b>addfood.py</b> as 
         shown:</p>
        
<div class="listingBox"><div class="listingTitle">CODE TO TYPE:</div><div class="listing"><pre><ins>"""
Create the food table and add all necessary data.
Note that the foods are identified by the animal's
name and family, so we have to look up the primary key.
"""

import mysql.connector
from database import login_info

db = mysql.connector.Connect(**login_info)
cursor = db.cursor()

cursor.execute("""DROP TABLE IF EXISTS food""")
cursor.execute("""
    CREATE TABLE food (
        id INTEGER PRIMARY KEY AUTO_INCREMENT,
        anid INTEGER,
        feed VARCHAR(20),
        FOREIGN KEY (anid) REFERENCES animal(id)) ENGINE = MYISAM
    """)

data = [('Ellie', 'Elephant', ['hay', 'peanuts']),
        ('Gerald', 'Gnu', ['leaves', 'shoots']),
        ('Gerald', 'Giraffe', ['hay', 'grass']),
        ('Leonard', 'Leopard', ['meat']),
        ('Sam', 'Snake', ['mice', 'meat']),
        ('Steve', 'Snake', ['mice', 'meat']),
        ('Zorro', 'Zebra', ['grass', 'leaves'])]

for name, family, foods in data:
    cursor.execute("SELECT id FROM animal WHERE name=%s and family=%s",
                 (name, family))
    id = cursor.fetchone()[0]
    for food in foods:
        cursor.execute("""INSERT INTO food (anid, feed)
                        VALUES (%s, %s)""", (id, food))
    db.commit()
    print("Processed", name, family, id)
</ins>
</pre></div></div>
     <p></p><div class="c"><table class="noteBox fBox pBox "><tbody><tr><td class="noteTitle">Note</td><td class="note">Unlike <b>tablepop.py</b>, this program does not require that the table be created before
     it is run. To remove any uncertainty about the state of the table, the <b>DROP TABLE IF EXISTS</b>
     statement is present to make sure that no food table exists when the <b>CREATE TABLE</b> statement
         is executed. If no such table exists then the <b>DROP TABLE IF EXISTS</b> statement has no effect.</td></tr></tbody></table></div><p></p>
        
        <p><img src="./Handling Databases_files/icon_run.png"> When you run the program, it prints out each
            animal's details:</p> 
     
<div class="observeBox"><div class="observeTitle">OBSERVE: Output from addfood.py</div><div class="observe"><pre>Processed Ellie Elephant 1
Processed Gerald Gnu 2
Processed Gerald Giraffe 3
Processed Leonard Leopard 4
Processed Sam Snake 5
Processed Steve Snake 6
Processed Zorro Zebra 7         
</pre></div></div>
     <p>So now you have a record of which animals eat which foods. Again, this is expressed as a 
         relationship: animals eat food (one-to-many), food is-eaten-by animal (many-to-one). Now try a few 
         queries through the interactive window. Use mysql to query the database:</p>

<div class="interactiveBox"><div class="interactiveTitle">INTERACTIVE SESSION:</div><div class="interactive"><pre>mysql&gt; <ins>SELECT * FROM food;</ins>
+----+------+---------+
| id | anid | feed    |
+----+------+---------+
|  1 |    1 | hay     |
|  2 |    1 | peanuts |
|  3 |    2 | leaves  |
|  4 |    2 | shoots  |
|  5 |    3 | hay     |
|  6 |    3 | grass   |
|  7 |    4 | meat    |
|  8 |    5 | mice    |
|  9 |    5 | meat    |
| 10 |    6 | mice    |
| 11 |    6 | meat    |
| 12 |    7 | grass   |
| 13 |    7 | leaves  |
+----+------+---------+
13 rows in set (0.04 sec)

mysql&gt; <ins>SELECT name, family, feed</ins>
    -&gt; <ins>FROM animal JOIN food ON animal.id=food.anid</ins>
    -&gt; <ins>WHERE feed IN ('meat', 'leaves');</ins>
+---------+---------+--------+
| name    | family  | feed   |
+---------+---------+--------+
| Gerald  | Gnu     | leaves |
| Leonard | Leopard | meat   |
| Sam     | Snake   | meat   |
| Steve   | Snake   | meat   |
| Zorro   | Zebra   | leaves |
+---------+---------+--------+
5 rows in set (0.05 sec)

mysql&gt; <ins>SELECT feed</ins>
    -&gt; <ins>FROM animal JOIN food ON animal.id=food.anid</ins>
    -&gt; <ins>WHERE name='Sam' AND Family='Snake';</ins>
+------+
| feed |
+------+
| mice |
| meat |
+------+
2 rows in set (0.04 sec)

mysql&gt; <ins>SELECT COUNT(*) FROM food WHERE feed='meat';</ins>
+----------+
| COUNT(*) |
+----------+
|        3 |
+----------+
1 row in set (0.04 sec)

mysql&gt; 
</pre></div></div>
        <p>The output shows that each row in the food table contains the relevant animal id. By
            joining the animal table to the food table on equality of animal id, we produce output
            containing one row for each combination of animal and food. A given animal can be
            associated with multiple foods, and the animal data is duplicated as many times as
            necessary, once for each related food row. That's how the SQL JOIN feature works.</p>
    
 </div>
 <a name="h_08"></a><div class="heading">Using Relational Data in Python</div><div class="headingText">

        <p>For almost thirty years now, the relational database has been the dominant model for
            storing persistent data. As you saw in an earlier lesson, Python has its own mechanisms,
            which are great when only Python programs are concerned, but not so useful when
            multiple languages must be used. In addition, there is a huge amount of "legacy data" already
            stored in databases, and Python would not be a very good programming language if it couldn't make use
            of that data. Of course now you understand that it can, although you've only used
            MySQL, there are Python drivers for almost every imaginable database. </p>

        <p>When you use a database (or any other persistent data store) you are effectively creating
            a model of selected portions of the world. Though the model describes only those aspects of the
            world that are of interest to your application. For instance, when writing a hospital
            information system, you would probably want to know the names and birth dates of the
            patients, but most likely not their favorite football team or the kind of car they
            drive. Similarly, you would probably want to know how many beds are in each ward, but
            the color the walls are painted would not be particularly relevant. </p>

        <p>The value of these models is that if you can keep them up to date (by changing them as
            the world changes—reducing the stock quantity of a product when some is sold,
            for example—you can <i>answer questions about the real world by querying the
                model</i>. If someone sends an order in for six widgets and you only have three in
            stock, you can respond by telling the customer there will be a slight delay, and then
            order more widgets from your supplier without having to walk to the warehouse and check
            the physical stock. </p>

        <a name="s_01"></a><div id="s_01"><div class="subheading">Metadata: Data about Data</div><div class="subheadingText">

            <p>One of the remarkable things about relational structures is that they're powerful
                enough to describe other relational structures. Since a database is packed full of
                routines to handle relational structures, it makes sense
                that most relational database management systems (RDBMSs) actually store a
                relational description of the application data structures they are used to create. </p>

            <p>
               </p><div class="c"><table class="noteBox fBox pBox "><tbody><tr><td class="noteTitle">Note</td><td class="note"> This description is often called the <i>data dictionary</i>, or 
                    the <i>system catalog</i>, or various other names. Many databases even allow
                    you to retrieve data from the data dictionary, thereby allowing you to query the
                    structure of the database (the data dictionary is comprised of tables, after all). If
                    you are given access to the data dictionary, please remember <i>never</i> to try
                    to update those tables directly yourself (unless you happen to be an experienced
                    database administrator)—that's the RDBMS's job!</td></tr></tbody></table></div> 
            <p></p>

           <p> If you want to experiment with databases on your own computer, take a look at
                a standard library module, <b>sqlite3</b>, that lets you create and use relational
                structures without the complexity of an external database server and client/server
                communications. All data are stored in files held on the same computer that the
                programs run on. <b>sqlite3</b> has some limitations and a few quirks but it's a good place to start, 
               and has been used to support many production programs.</p>
            <p>Phew! Let's take a little break before moving on to the next lesson... okay, break's over. Let's go!</p>

        </div></div>
    </div>
<div class="footer"><div id="timeSurvey"><iframe frameborder="0" width="400" height="150" src="./Handling Databases_files/time_survey.html"></iframe></div>				
				Copyright © 1998-2014 O'Reilly Media, Inc.<br><img src="./Handling Databases_files/cclicense.png"><br>
				This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License.<br>
				See <a href="http://creativecommons.org/licenses/by-sa/3.0/legalcode">http://creativecommons.org/licenses/by-sa/3.0/legalcode</a> 
				for more information.
				</div><iframe id="t" width="1" height="1" border="0" style="display:none" src="about:blank"></iframe><script language="javascript">bodyLoaded();</script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-44720547-1', 'oreillyschool.com');
  ga('send', 'pageview');
</script></body></html>